import { Component, OnInit } from '@angular/core';
import { Router } from '@angular/router';
import { MatDialog } from '@angular/material/dialog';
import * as L from 'leaflet';
import * as proj4 from 'proj4';
import * as proj4L from 'proj4leaflet';
import * as $ from "jquery";

// Open layers imports


import {BusquedaComponent} from '../busqueda/busqueda.component';
import {LoginComponent} from '../auth/login/login.component';

@Component({
  selector: 'app-inicio',
  templateUrl: './inicio.component.html',
  styleUrls: ['./inicio.component.css']
})
export class InicioComponent implements OnInit {

  jsonEx = {"type":"FeatureCollection","totalFeatures":150,"features":[{"type":"Feature","id":"TorresP1.1","geometry":{"type":"MultiPolygon","coordinates":[[[[675829.86195912,4616777.07421584],[675829.96396083,4616777.07577406],[675829.96472877,4616776.97461889],[675830.21973813,4616776.97851452],[675830.21897019,4616777.07966969],[675836.75746126,4616777.17955444],[675836.7582292,4616777.07839927],[675837.01323856,4616777.0822949],[675837.01247062,4616777.18345007],[675837.11447232,4616777.18500829],[675837.16386109,4616770.67938522],[675836.7048473,4616770.67237313],[675836.70767717,4616770.29961542],[675830.37319155,4616770.20284714],[675830.37036168,4616770.57560485],[675829.91134789,4616770.56859277],[675829.86195912,4616777.07421584]]]]},"geometry_name":"geom","properties":{"layer":"01.090","id_utc":"01.090","id_centro":"SALA ORDENADORES","tipo_de_us":45}},{"type":"Feature","id":"TorresP1.2","geometry":{"type":"MultiPolygon","coordinates":[[[[675823.03782183,4616780.1059442],[675823.07619281,4616775.05161453],[675821.20176383,4616775.02297996],[675820.2939305,4616775.00911152],[675820.2225289,4616775.00802076],[675819.96197767,4616775.00404047],[675819.92360669,4616780.05837014],[675823.03782183,4616780.1059442]]]]},"geometry_name":"geom","properties":{"layer":"01.100","id_utc":"01.100","id_centro":"BAÑOS","tipo_de_us":7}},{"type":"Feature","id":"TorresP1.3","geometry":{"type":"MultiPolygon","coordinates":[[[[675847.29602303,4616780.47652271],[675847.33439401,4616775.42219304],[675847.0738438,4616775.41821277],[675847.00244118,4616775.41712199],[675846.09460887,4616775.40325356],[675843.92937129,4616775.37017648],[675843.89100031,4616780.42450615],[675847.29602303,4616780.47652271]]]]},"geometry_name":"geom","properties":{"layer":"01.110","id_utc":"01.110","id_centro":"CUARTO LIMPIEZA","tipo_de_us":2}},{"type":"Feature","id":"TorresP1.4","geometry":{"type":"MultiPolygon","coordinates":[[[[675865.30693142,4616780.75166495],[675865.37943493,4616771.20130415],[675863.03398326,4616771.16547404],[675863.03729006,4616770.72989262],[675858.3546837,4616770.65835915],[675858.35182203,4616771.03530646],[675857.8418033,4616771.0275152],[675857.84466497,4616770.65056789],[675851.39293115,4616770.55200849],[675851.3915473,4616770.73429333],[675851.16508369,4616770.73083378],[675851.09065721,4616780.53449114],[675865.30693142,4616780.75166495]]]]},"geometry_name":"geom","properties":{"layer":"01.120","id_utc":"01.120","id_centro":"AULA_19","tipo_de_us":6}},{"type":"Feature","id":"TorresP1.5","geometry":{"type":"MultiPolygon","coordinates":[[[[675879.23770427,4616780.96447731],[675879.31197878,4616771.18083735],[675879.08246423,4616771.17733119],[675879.08400005,4616770.97502893],[675872.62501376,4616770.87635873],[675872.62215209,4616771.25330604],[675872.11213337,4616771.24551478],[675872.11499504,4616770.86856747],[675867.83020226,4616770.80311117],[675867.82689545,4616771.23869259],[675865.4814448,4616771.2028625],[675865.40894128,4616780.75322329],[675879.23770427,4616780.96447731]]]]},"geometry_name":"geom","properties":{"layer":"01.130","id_utc":"01.130","id_centro":"AULA_17","tipo_de_us":6}},{"type":"Feature","id":"TorresP1.6","geometry":{"type":"MultiPolygon","coordinates":[[[[675879.89854094,4616765.25422441],[675886.49131856,4616765.3551853],[675886.52224087,4616761.28201508],[675886.29930964,4616761.27860949],[675886.3020383,4616760.91918323],[675879.93219003,4616760.82187474],[675879.89854094,4616765.25422441]]]]},"geometry_name":"geom","properties":{"layer":"01.150","id_utc":"01.150","id_centro":"CD 1 17","tipo_de_us":42}},{"type":"Feature","id":"TorresP1.7","geometry":{"type":"MultiPolygon","coordinates":[[[[675879.85453061,4616771.051384],[675882.36924628,4616771.08979985],[675882.37564624,4616770.24677973],[675883.9934236,4616770.27149358],[675884.01202649,4616767.82107057],[675879.87953346,4616767.75794086],[675879.85453061,4616771.051384]]]]},"geometry_name":"geom","properties":{"layer":"01.160","id_utc":"01.160","id_centro":"CD 1 15","tipo_de_us":3}},{"type":"Feature","id":"TorresP1.8","geometry":{"type":"MultiPolygon","coordinates":[[[[675882.3684784,4616771.19094693],[675879.85376273,4616771.15253108],[675879.82862239,4616774.46408496],[675883.96111542,4616774.52721466],[675883.9798558,4616772.05868091],[675882.36207844,4616772.03396706],[675882.3684784,4616771.19094693]]]]},"geometry_name":"geom","properties":{"layer":"01.170","id_utc":"01.170","id_centro":"CD 1 16","tipo_de_us":3}},{"type":"Feature","id":"TorresP1.9","geometry":{"type":"MultiPolygon","coordinates":[[[[675883.91029574,4616781.221321],[675879.77780272,4616781.15819129],[675879.77139653,4616782.00203143],[675879.72651078,4616787.91450433],[675886.1454963,4616788.01256346],[675886.14735119,4616787.76823274],[675886.35135562,4616787.7713492],[675886.38143438,4616783.8092933],[675883.89093746,4616783.77124742],[675883.91029574,4616781.221321]]]]},"geometry_name":"geom","properties":{"layer":"01.180","id_utc":"01.180","id_centro":"CD 1 9","tipo_de_us":53}},{"type":"Feature","id":"TorresP1.10","geometry":{"type":"MultiPolygon","coordinates":[[[[675886.48342894,4616783.81085141],[675886.45335018,4616787.77290731],[675886.65736991,4616787.776024],[675886.65551503,4616788.02035472],[675893.08173873,4616788.11852443],[675893.08359362,4616787.87419371],[675893.28761335,4616787.8773104],[675893.31769211,4616783.9152545],[675886.48342894,4616783.81085141]]]]},"geometry_name":"geom","properties":{"layer":"01.190","id_utc":"01.190","id_centro":"CD 1 8","tipo_de_us":53}},{"type":"Feature","id":"TorresP1.11","geometry":{"type":"MultiPolygon","coordinates":[[[[675893.41968667,4616783.91681261],[675893.38960791,4616787.87886851],[675893.59361234,4616787.88198497],[675893.59175746,4616788.12631569],[675900.01799646,4616788.22448562],[675900.06758712,4616781.69226843],[675895.72531523,4616781.62593405],[675895.70765822,4616783.95176463],[675893.41968667,4616783.91681261]]]]},"geometry_name":"geom","properties":{"layer":"01.200","id_utc":"01.200","id_centro":"CD 1 7","tipo_de_us":18}},{"type":"Feature","id":"TorresP1.12","geometry":{"type":"MultiPolygon","coordinates":[[[[675895.72608312,4616781.52478596],[675900.06835501,4616781.59112033],[675900.11805769,4616775.04414852],[675899.79928068,4616775.03927875],[675899.80077895,4616774.84192268],[675895.77728407,4616774.78045808],[675895.72608312,4616781.52478596]]]]},"geometry_name":"geom","properties":{"layer":"01.210","id_utc":"01.210","id_centro":"CD 1 6","tipo_de_us":53}},{"type":"Feature","id":"TorresP1.13","geometry":{"type":"MultiPolygon","coordinates":[[[[675895.77805195,4616774.67930999],[675899.80154684,4616774.74077459],[675899.80312015,4616774.53353323],[675900.12189716,4616774.538403],[675900.17027451,4616768.16600644],[675900.17177278,4616767.96865038],[675895.82950089,4616767.902316],[675895.77805195,4616774.67930999]]]]},"geometry_name":"geom","properties":{"layer":"01.220","id_utc":"01.220","id_centro":"CD 1 5","tipo_de_us":53}},{"type":"Feature","id":"TorresP1.14","geometry":{"type":"MultiPolygon","coordinates":[[[[675895.83026878,4616767.80116791],[675900.17254067,4616767.86750229],[675900.19793128,4616764.52298088],[675895.85565939,4616764.4566465],[675895.83026878,4616767.80116791]]]]},"geometry_name":"geom","properties":{"layer":"01.230","id_utc":"01.230","id_centro":"CD 1 4","tipo_de_us":53}},{"type":"Feature","id":"TorresP1.15","geometry":{"type":"MultiPolygon","coordinates":[[[[675895.85642727,4616764.35549942],[675900.19869916,4616764.4218338],[675900.2236757,4616761.13185604],[675895.88140381,4616761.06552166],[675895.85642727,4616764.35549942]]]]},"geometry_name":"geom","properties":{"layer":"01.240","id_utc":"01.240","id_centro":"CD 1 3","tipo_de_us":53}},{"type":"Feature","id":"TorresP1.16","geometry":{"type":"MultiPolygon","coordinates":[[[[675893.57452597,4616760.78166998],[675893.64632436,4616760.7827668],[675893.64709227,4616760.68161567],[675893.78882342,4616760.68378082],[675893.78693622,4616760.93236688],[675900.22444358,4616761.03070895],[675900.22633077,4616760.7821229],[675900.48134014,4616760.78601853],[675900.50437696,4616757.75154542],[675900.35137746,4616757.74920813],[675900.35291323,4616757.54691296],[675897.13978608,4616757.49782788],[675897.13825031,4616757.70012305],[675896.88324095,4616757.69622742],[675896.88477671,4616757.49393225],[675893.67166486,4616757.4448474],[675893.6701291,4616757.64714257],[675893.5983307,4616757.64604574],[675893.57452597,4616760.78166998]]]]},"geometry_name":"geom","properties":{"layer":"01.250","id_utc":"01.250","id_centro":"CD 1 2","tipo_de_us":53}},{"type":"Feature","id":"TorresP1.17","geometry":{"type":"MultiPolygon","coordinates":[[[[675886.59333033,4616765.35649279],[675893.42757629,4616765.4611465],[675893.4584986,4616761.38797628],[675893.23556839,4616761.3845707],[675893.24095212,4616760.67541131],[675893.39208291,4616760.67772004],[675893.391315,4616760.77887117],[675893.47251508,4616760.78011161],[675893.49631981,4616757.64448738],[675893.41511973,4616757.64324694],[675893.4166555,4616757.44095176],[675890.20354365,4616757.39186691],[675890.20200788,4616757.59416208],[675889.94699852,4616757.59026645],[675889.94853428,4616757.38797128],[675886.73540713,4616757.3388862],[675886.73387137,4616757.54118137],[675886.65267128,4616757.53994092],[675886.62886655,4616760.67556515],[675886.71006663,4616760.6768056],[675886.71083454,4616760.57565448],[675886.85256569,4616760.57781962],[675886.84718196,4616761.28697902],[675886.62425073,4616761.28357343],[675886.59333033,4616765.35649279]]]]},"geometry_name":"geom","properties":{"layer":"01.260","id_utc":"01.260","id_centro":"AULA DE DIRECCIÓN","tipo_de_us":52}},{"type":"Feature","id":"TorresP1.18","geometry":{"type":"MultiPolygon","coordinates":[[[[675893.52958616,4616765.46270484],[675895.74574298,4616765.49655979],[675895.77939395,4616761.06396331],[675893.78616834,4616761.03351396],[675893.78343969,4616761.39294022],[675893.56050846,4616761.38953463],[675893.52958616,4616765.46270484]]]]},"geometry_name":"geom","properties":{"layer":"01.270","id_utc":"01.270","id_centro":"PASILLO","tipo_de_us":31}},{"type":"Feature","id":"TorresP1.19","geometry":{"type":"MultiPolygon","coordinates":[[[[675865.59260719,4616756.56025023],[675867.93805784,4616756.59608032],[675867.93475106,4616757.0316587],[675872.21954384,4616757.09711501],[675872.22240551,4616756.7201677],[675872.73242424,4616756.72795896],[675872.72956256,4616757.10490627],[675879.15578627,4616757.20307597],[675879.15717009,4616757.02079517],[675879.41522937,4616757.02473739],[675879.48965587,4616747.22107598],[675865.66511073,4616747.0098864],[675865.59260719,4616756.56025023]]]]},"geometry_name":"geom","properties":{"layer":"01.320","id_utc":"01.320","id_centro":"AULA_17","tipo_de_us":6}},{"type":"Feature","id":"TorresP1.20","geometry":{"type":"MultiPolygon","coordinates":[[[[675851.27240016,4616756.59481566],[675851.49886378,4616756.59827522],[675851.49747995,4616756.78055602],[675857.94921377,4616756.87911542],[675857.95207545,4616756.50216812],[675858.46209417,4616756.50995938],[675858.4592325,4616756.88690669],[675863.14183886,4616756.95844016],[675863.14514565,4616756.52286177],[675865.49059732,4616756.55869188],[675865.56310086,4616747.00832805],[675851.34682666,4616746.79115425],[675851.27240016,4616756.59481566]]]]},"geometry_name":"geom","properties":{"layer":"01.330","id_utc":"01.330","id_centro":"AULA_16","tipo_de_us":6}},{"type":"Feature","id":"TorresP1.21","geometry":{"type":"MultiPolygon","coordinates":[[[[675843.7982387,4616756.12295578],[675843.8699501,4616746.67693433],[675833.77158546,4616746.52266745],[675833.69556214,4616756.53666539],[675836.81180002,4616756.58427036],[675836.81462988,4616756.21151265],[675837.27364367,4616756.21852473],[675837.27081381,4616756.59128245],[675841.69967974,4616756.65893967],[675841.70399165,4616756.09096318],[675843.7982387,4616756.12295578]]]]},"geometry_name":"geom","properties":{"layer":"01.340","id_utc":"01.340","id_centro":"AULA_15","tipo_de_us":6}},{"type":"Feature","id":"TorresP1.22","geometry":{"type":"MultiPolygon","coordinates":[[[[675823.49949954,4616755.81286368],[675825.59374659,4616755.84485628],[675825.58943468,4616756.41283277],[675830.01830061,4616756.48048999],[675830.02113047,4616756.10773228],[675830.48014427,4616756.11474437],[675830.4773144,4616756.48750208],[675833.59355227,4616756.53510705],[675833.66957559,4616746.52110911],[675823.57121094,4616746.36684223],[675823.49949954,4616755.81286368]]]]},"geometry_name":"geom","properties":{"layer":"01.350","id_utc":"01.350","id_centro":"AULA_14","tipo_de_us":6}},{"type":"Feature","id":"TorresP1.23","geometry":{"type":"MultiPolygon","coordinates":[[[[675802.20337125,4616755.59188952],[675804.54882292,4616755.62771963],[675804.54551614,4616756.06329802],[675808.8303079,4616756.1287543],[675808.83316957,4616755.75180699],[675809.3431883,4616755.75959826],[675809.34032662,4616756.13654556],[675815.79206044,4616756.23510497],[675815.79344427,4616756.05282417],[675816.01990788,4616756.05628372],[675816.09433438,4616746.25262231],[675802.27587479,4616746.04152569],[675802.20337125,4616755.59188952]]]]},"geometry_name":"geom","properties":{"layer":"01.360","id_utc":"01.360","id_centro":"AULA_13","tipo_de_us":6}},{"type":"Feature","id":"TorresP1.24","geometry":{"type":"MultiPolygon","coordinates":[[[[675788.27488512,4616755.63243905],[675788.53294542,4616755.63638129],[675788.53156159,4616755.81866209],[675794.9578006,4616755.91683203],[675794.96066227,4616755.53988472],[675795.470681,4616755.54767598],[675795.46781932,4616755.92462329],[675799.75260394,4616755.99007947],[675799.75591073,4616755.55450108],[675802.10136954,4616755.5903313],[675802.17387308,4616746.03996747],[675788.34931162,4616745.82877764],[675788.27488512,4616755.63243905]]]]},"geometry_name":"geom","properties":{"layer":"01.370","id_utc":"01.370","id_centro":"AULA_12","tipo_de_us":6}},{"type":"Feature","id":"TorresP1.25","geometry":{"type":"MultiPolygon","coordinates":[[[[675774.17391232,4616757.64256095],[675776.76711685,4616757.68217625],[675776.75483052,4616759.30056453],[675780.78226453,4616759.36208931],[675780.78533611,4616758.95749188],[675780.99895258,4616758.96075518],[675781.0219894,4616755.92628207],[675780.95010408,4616755.92518392],[675780.95163984,4616755.72288875],[675777.73851983,4616755.67380377],[675777.73698407,4616755.87609895],[675777.4819747,4616755.87220331],[675777.48351047,4616755.66990814],[675774.27039454,4616755.62082323],[675774.26885877,4616755.8231184],[675774.18773439,4616755.82187911],[675774.17391232,4616757.64256095]]]]},"geometry_name":"geom","properties":{"layer":"01.382","id_utc":"01.382","id_centro":"PASILLO","tipo_de_us":31}},{"type":"Feature","id":"TorresP1.26","geometry":{"type":"MultiPolygon","coordinates":[[[[675787.64854028,4616766.24475834],[675782.77614065,4616766.1703255],[675782.7504162,4616769.55882047],[675787.62281583,4616769.6332533],[675787.64854028,4616766.24475834]]]]},"geometry_name":"geom","properties":{"layer":"01.385","id_utc":"01.385","id_centro":"DESPACHO CB1 1 19","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.27","geometry":{"type":"MultiPolygon","coordinates":[[[[675767.38354287,4616762.44513341],[675772.3141999,4616762.52045621],[675772.320727,4616761.66068934],[675774.04581434,4616761.6870425],[675774.06193167,4616759.56402397],[675773.84369873,4616759.56069015],[675773.84524297,4616759.3572793],[675767.40773153,4616759.25893716],[675767.38354287,4616762.44513341]]]]},"geometry_name":"geom","properties":{"layer":"01.386","id_utc":"01.386","id_centro":"DESPACHO C1 1 1","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.28","geometry":{"type":"MultiPolygon","coordinates":[[[[675767.3578184,4616765.8336299],[675772.28847544,4616765.9089527],[675772.31343201,4616762.62160532],[675767.38277497,4616762.54628252],[675767.3578184,4616765.8336299]]]]},"geometry_name":"geom","properties":{"layer":"01.388","id_utc":"01.388","id_centro":"DESPACHO C1 1 2","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.120","geometry":{"type":"MultiPolygon","coordinates":[[[[675888.83894702,4616815.91826629],[675892.21016366,4616815.96976642],[675892.24395102,4616811.51920384],[675888.87273438,4616811.46770371],[675888.83894702,4616815.91826629]]]]},"geometry_name":"geom","properties":{"layer":"01.B50","id_utc":"01.B50","id_centro":"C3 1 18","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.29","geometry":{"type":"MultiPolygon","coordinates":[[[[675796.83548917,4616814.61393439],[675796.78096871,4616821.79551872],[675797.90300991,4616821.81265848],[675797.86346333,4616827.02184136],[675796.74142214,4616827.00469958],[675796.68690168,4616834.1862839],[675800.11422751,4616834.23864118],[675800.16951587,4616826.95590876],[675801.72507502,4616826.97967214],[675801.72661084,4616826.77736988],[675802.13462684,4616826.78360291],[675802.13309102,4616826.98590516],[675819.05839586,4616827.24447944],[675819.06108349,4616826.89045859],[675819.75267092,4616826.90102357],[675819.75075118,4616827.15389633],[675820.66878591,4616827.16792062],[675820.67070564,4616826.91504786],[675821.62545764,4616826.92963305],[675821.6235379,4616827.18250581],[675822.54157365,4616827.19653011],[675822.54349338,4616826.94365735],[675823.14123329,4616826.95278868],[675823.13854567,4616827.30680953],[675843.17569215,4616827.61290543],[675843.17837977,4616827.25888458],[675843.77611968,4616827.26801591],[675843.77419994,4616827.52088867],[675844.69223569,4616827.53491297],[675844.69415542,4616827.28204021],[675845.64890742,4616827.2966254],[675845.64698768,4616827.54949817],[675846.56502241,4616827.56352245],[675846.56694214,4616827.31064969],[675847.25852957,4616827.32121467],[675847.25584195,4616827.67523552],[675864.17727084,4616827.93372632],[675864.17880666,4616827.73142305],[675864.58683082,4616827.7376562],[675864.585295,4616827.93995946],[675866.14084599,4616827.96372272],[675866.08555758,4616835.24646323],[675869.51288443,4616835.29882052],[675869.56740497,4616828.11722709],[675868.54736752,4616828.10164457],[675868.58691407,4616822.89246472],[675869.60695152,4616822.90804725],[675869.661472,4616815.72646191],[675866.23414514,4616815.67410462],[675866.17885679,4616822.95683703],[675864.6233058,4616822.93307378],[675864.62176997,4616823.13537705],[675864.21374581,4616823.1291439],[675864.21528163,4616822.92684063],[675847.29384465,4616822.66834162],[675847.28871109,4616823.345623],[675846.72768743,4616823.33705256],[675846.72960717,4616823.0841798],[675846.93361874,4616823.08729637],[675846.95607967,4616820.12868105],[675845.39287126,4616820.10480082],[675845.39056755,4616820.40825217],[675843.47034704,4616820.37891807],[675843.45824612,4616821.97288532],[675843.62655332,4616821.97545646],[675843.62270729,4616822.48206579],[675843.16368635,4616822.47505359],[675843.1667645,4616822.06959134],[675841.02468688,4616822.03686806],[675841.0150882,4616823.30123185],[675825.36410684,4616823.06214086],[675825.37370552,4616821.79777707],[675823.23162789,4616821.76505378],[675823.22854974,4616822.17051603],[675822.76952881,4616822.16350384],[675822.77337484,4616821.65689451],[675822.94168204,4616821.65946564],[675822.95378296,4616820.06549839],[675821.03356246,4616820.03616429],[675821.03586617,4616819.73271293],[675819.47265776,4616819.7088327],[675819.45019683,4616822.66744803],[675819.6542084,4616822.67056459],[675819.65228866,4616822.92343735],[675819.091265,4616822.91486692],[675819.09640678,4616822.23757859],[675802.17110181,4616821.97902049],[675802.16956599,4616822.18132274],[675801.76154999,4616822.17508972],[675801.76308581,4616821.97278747],[675800.20752666,4616821.94902409],[675800.26281501,4616814.66629167],[675796.83548917,4616814.61393439]]]]},"geometry_name":"geom","properties":{"layer":"01.390","id_utc":"01.390","id_centro":"PASILLO","tipo_de_us":27}},{"type":"Feature","id":"TorresP1.30","geometry":{"type":"MultiPolygon","coordinates":[[[[675767.33132609,4616769.32326993],[675772.26198311,4616769.39859475],[675772.28770756,4616766.01009978],[675767.35705053,4616765.93477698],[675767.33132609,4616769.32326993]]]]},"geometry_name":"geom","properties":{"layer":"01.400","id_utc":"01.400","id_centro":"DESPACHO C1 1 3","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.31","geometry":{"type":"MultiPolygon","coordinates":[[[[675767.62592257,4616772.51433861],[675767.62438678,4616772.71663681],[675772.23625865,4616772.78708971],[675772.26121521,4616769.49974385],[675767.33055818,4616769.42442105],[675767.30713741,4616772.50946871],[675767.62592257,4616772.51433861]]]]},"geometry_name":"geom","properties":{"layer":"01.402","id_utc":"01.402","id_centro":"DESPACHO C1 1 4","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.32","geometry":{"type":"MultiPolygon","coordinates":[[[[675767.6220831,4616773.02008412],[675767.30329794,4616773.01521423],[675767.27987717,4616776.10026189],[675772.2105342,4616776.17558468],[675772.23549076,4616772.88823882],[675767.62361889,4616772.81778592],[675767.6220831,4616773.02008412]]]]},"geometry_name":"geom","properties":{"layer":"01.404","id_utc":"01.404","id_centro":"DESPACHO C1 1 5","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.33","geometry":{"type":"MultiPolygon","coordinates":[[[[675767.27910926,4616776.20141301],[675767.25363273,4616779.55724997],[675772.18428977,4616779.63257277],[675772.2097663,4616776.27673379],[675767.27910926,4616776.20141301]]]]},"geometry_name":"geom","properties":{"layer":"01.406","id_utc":"01.406","id_centro":"DESPACHO C1 1 6","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.34","geometry":{"type":"MultiPolygon","coordinates":[[[[675767.22843472,4616782.87640065],[675772.15909175,4616782.95172345],[675772.18352187,4616779.73372187],[675767.25286484,4616779.65839907],[675767.22843472,4616782.87640065]]]]},"geometry_name":"geom","properties":{"layer":"01.408","id_utc":"01.408","id_centro":"DESPACHO C1 1 7","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.35","geometry":{"type":"MultiPolygon","coordinates":[[[[675767.22766683,4616782.97754976],[675767.20323671,4616786.19555134],[675773.62947163,4616786.29372121],[675773.63132652,4616786.04939049],[675773.83533401,4616786.052507],[675773.85790924,4616783.07883614],[675767.22766683,4616782.97754976]]]]},"geometry_name":"geom","properties":{"layer":"01.410","id_utc":"01.410","id_centro":"DESPACHO C1 1 8","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.36","geometry":{"type":"MultiPolygon","coordinates":[[[[675777.35317119,4616781.2373599],[675773.97429662,4616781.18574279],[675773.93733776,4616786.05406525],[675774.14134525,4616786.05718175],[675774.13949036,4616786.30151247],[675777.31435744,4616786.35001308],[675777.35317119,4616781.2373599]]]]},"geometry_name":"geom","properties":{"layer":"01.412","id_utc":"01.412","id_centro":"DESPACHO C1 1 8","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.37","geometry":{"type":"MultiPolygon","coordinates":[[[[675777.45517494,4616781.23891815],[675777.41636118,4616786.35157133],[675780.56572528,4616786.39968235],[675780.56758017,4616786.15535163],[675780.79709064,4616786.15885773],[675780.8340495,4616781.29053526],[675777.45517494,4616781.23891815]]]]},"geometry_name":"geom","properties":{"layer":"01.414","id_utc":"01.414","id_centro":"DESPACHO C1 1 10","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.38","geometry":{"type":"MultiPolygon","coordinates":[[[[675787.51915658,4616783.28753111],[675780.92166859,4616783.1867451],[675780.89909336,4616786.16041596],[675781.0775989,4616786.16314289],[675781.07574401,4616786.40747361],[675787.49472647,4616786.50553269],[675787.51915658,4616783.28753111]]]]},"geometry_name":"geom","properties":{"layer":"01.416","id_utc":"01.416","id_centro":"DESPAHO C1 1 11","tipo_de_us":30}},{"type":"Feature","id":"TorresP1.39","geometry":{"type":"MultiPolygon","coordinates":[[[[675787.5443546,4616779.96838043],[675782.67195496,4616779.8939476],[675782.64752484,4616783.11194918],[675787.51992448,4616783.18638201],[675787.5443546,4616779.96838043]]]]},"geometry_name":"geom","properties":{"layer":"01.418","id_utc":"01.418","id_centro":"CUARTO FOTOCOPIAS C1 1 12","tipo_de_us":30}},{"type":"Feature","id":"TorresP1.40","geometry":{"type":"MultiPolygon","coordinates":[[[[675772.2610955,4616782.9532817],[675773.85867707,4616782.97769614],[675773.87306077,4616781.08303543],[675780.93682012,4616781.1909444],[675780.92243642,4616783.0856051],[675782.5455211,4616783.11039092],[675782.70140633,4616762.57797826],[675787.67580049,4616762.65396921],[675787.69922129,4616759.56891852],[675781.32937607,4616759.47161007],[675781.32783184,4616759.67502092],[675781.09557157,4616759.67147281],[675781.07868635,4616761.89564045],[675772.42196285,4616761.76339669],[675772.2610955,4616782.9532817]],[[675777.30843336,4616770.66928313],[675777.30612965,4616770.97273348],[675777.68354249,4616770.97849899],[675777.70657931,4616767.94402589],[675779.23663549,4616767.96739967],[675779.24991933,4616766.21761627],[675780.76977615,4616766.24083424],[675780.66712626,4616779.76215712],[675774.18988641,4616779.66320807],[675774.2925363,4616766.1418852],[675775.81239414,4616766.16510319],[675775.80165661,4616767.57947919],[675777.70912563,4616767.60861849],[675777.70657931,4616767.94402589],[675779.23663549,4616767.96739967],[675779.20208026,4616772.51910933],[675775.76455506,4616772.46659625],[675775.77837718,4616770.64590935],[675777.30843336,4616770.66928313]]]]},"geometry_name":"geom","properties":{"layer":"01.420","id_utc":"01.420","id_centro":"PASILLO","tipo_de_us":31}},{"type":"Feature","id":"TorresP1.41","geometry":{"type":"MultiPolygon","coordinates":[[[[675787.57059903,4616776.51139235],[675782.6981994,4616776.43695951],[675782.67272286,4616779.79279849],[675787.54512249,4616779.86723133],[675787.57059903,4616776.51139235]]]]},"geometry_name":"geom","properties":{"layer":"01.430","id_utc":"01.430","id_centro":"DESPAHO C1 1 12","tipo_de_us":10}},{"type":"Feature","id":"TorresP1.42","geometry":{"type":"MultiPolygon","coordinates":[[[[675787.59632348,4616773.12289738],[675782.72392385,4616773.04846455],[675782.69896729,4616776.33581041],[675787.57136692,4616776.41024324],[675787.59632348,4616773.12289738]]]]},"geometry_name":"geom","properties":{"layer":"01.432","id_utc":"01.432","id_centro":"DESPAHO C1 1 14","tipo_de_us":53}},{"type":"Feature","id":"TorresP1.43","geometry":{"type":"MultiPolygon","coordinates":[[[[675787.62204793,4616769.73440241],[675782.7496483,4616769.65996958],[675782.72469174,4616772.94731544],[675787.59709138,4616773.02174827],[675787.62204793,4616769.73440241]]]]},"geometry_name":"geom","properties":{"layer":"01.434","id_utc":"01.434","id_centro":"DESPAHO C1 1 15","tipo_de_us":53}},{"type":"Feature","id":"TorresP1.44","geometry":{"type":"MultiPolygon","coordinates":[[[[675802.09220888,4616770.23449876],[675802.01970534,4616779.78486259],[675815.83816493,4616779.9959592],[675815.91259144,4616770.19229779],[675815.68612782,4616770.18883824],[675815.68751164,4616770.00655744],[675809.23577782,4616769.90799803],[675809.23291615,4616770.28494534],[675808.72289742,4616770.27715408],[675808.7257591,4616769.90020677],[675804.44096734,4616769.83475048],[675804.43766056,4616770.27032887],[675802.09220888,4616770.23449876]]]]},"geometry_name":"geom","properties":{"layer":"01.440","id_utc":"01.440","id_centro":"ARCHIBO","tipo_de_us":31}},{"type":"Feature","id":"TorresP1.45","geometry":{"type":"MultiPolygon","coordinates":[[[[675788.16756868,4616769.76845312],[675788.09314217,4616779.57211453],[675801.91770363,4616779.78330436],[675801.99020718,4616770.23294054],[675799.64474836,4616770.19711032],[675799.64805514,4616769.76153193],[675795.36327052,4616769.69607576],[675795.36040885,4616770.07302306],[675794.85039013,4616770.0652318],[675794.8532518,4616769.6882845],[675788.42701279,4616769.59011456],[675788.42562897,4616769.77239536],[675788.16756868,4616769.76845312]]]]},"geometry_name":"geom","properties":{"layer":"01.445","id_utc":"01.445","id_centro":"AULA_10","tipo_de_us":6}},{"type":"Feature","id":"TorresP1.46","geometry":{"type":"MultiPolygon","coordinates":[[[[675823.10416882,4616771.36653926],[675820.05891229,4616771.32001864],[675820.04649529,4616772.95561987],[675816.43271374,4616772.90041422],[675816.37878376,4616780.00421792],[675819.82160499,4616780.05681191],[675819.85997597,4616775.00248224],[675819.11112669,4616774.99104251],[675819.11189457,4616774.88989543],[675823.07696069,4616774.95046745],[675823.10416882,4616771.36653926]]]]},"geometry_name":"geom","properties":{"layer":"01.450","id_utc":"01.450","id_centro":"AULA_11","tipo_de_us":6}},{"type":"Feature","id":"TorresP1.47","geometry":{"type":"MultiPolygon","coordinates":[[[[675847.39802576,4616780.47808095],[675850.55003839,4616780.52623242],[675850.60396836,4616773.42242872],[675846.99018682,4616773.36722307],[675847.00260382,4616771.73162184],[675843.9573473,4616771.68510121],[675843.93013917,4616775.2690294],[675847.43716461,4616775.3226042],[675847.39802576,4616780.47808095]]]]},"geometry_name":"geom","properties":{"layer":"01.455","id_utc":"01.455","id_centro":"ASEO","tipo_de_us":9}},{"type":"Feature","id":"TorresP1.48","geometry":{"type":"MultiPolygon","coordinates":[[[[675838.34953441,4616788.01889746],[675838.34735145,4616788.30644312],[675836.59666831,4616788.27969894],[675836.59885128,4616787.99215328],[675830.31536957,4616787.89616417],[675830.31318661,4616788.18370982],[675828.56250347,4616788.15696565],[675828.56468643,4616787.86941999],[675823.48954212,4616787.79188994],[675823.33366679,4616808.32421222],[675829.64947552,4616808.42069518],[675829.65254705,4616808.01610483],[675830.16256578,4616808.02389609],[675830.15949425,4616808.42848644],[675836.44297595,4616808.52447555],[675836.44604748,4616808.11988521],[675836.9560662,4616808.12767647],[675836.95299467,4616808.53226681],[675843.2688034,4616808.62874977],[675843.42467873,4616788.0964275],[675838.34953441,4616788.01889746]]]]},"geometry_name":"geom","properties":{"layer":"01.460","id_utc":"01.460","id_centro":"C","tipo_de_us":17}},{"type":"Feature","id":"TorresP1.49","geometry":{"type":"MultiPolygon","coordinates":[[[[675797.76222748,4616826.91913401],[675797.78096411,4616824.45109386],[675794.5678441,4616824.40200888],[675794.55064329,4616826.66774678],[675795.1881667,4616826.67748585],[675795.18663088,4616826.87978811],[675797.76222748,4616826.91913401]]]]},"geometry_name":"geom","properties":{"layer":"01.460","id_utc":"01.460","id_centro":"C","tipo_de_us":17}}],"crs":{"type":"name","properties":{"name":"EPSG:25830"}}}

  constructor(public router: Router, public matDialog: MatDialog) { }

  ngOnInit(): void {
    /*var map;
    map = L.map('map', {
      center: [ 39.8282, -98.5795 ],
      zoom: 3
    });

    const tiles = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    });

    tiles.addTo(map);


    var owsrootUrl = 'http://91.250.168.62:8082/geoserver/ows';

    var defaultParameters = {
      service: 'WFS',
      version: '1.0.0',
      request: 'GetFeature',
      typeName: 'SmartCampus:TorresP1',
      outputFormat: 'application/json'
    };
    var parameters = L.Util.extend(defaultParameters);

    var URL = owsrootUrl + L.Util.getParamString(parameters);

    $.ajax({
      url: URL,
      success: function (data) {
        var geojson = new L.geoJson(data, {
          style: {"color":"#2ECCFA","weight":2},
          onEachFeature: function(feature, layer){
            layer.bindPopup("Has hecho click en " + feature.properties.name);
          }}
        ).addTo(map);
      },
      error: function (error) {
        console.log('ERROR');
        console.log(error);
      }
    });


    var source = L.WMS.source("http://www.ign.es/wms-inspire/pnoa-ma?SERVICE=WMS&", {
      opacity: 0.5,
    });
    source.getLayer("OI.MosaicElement").addTo(map);*/

    try {
      var crs25830 = new proj4L.CRS('EPSG:25830',
        '+proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs', //http://spatialreference.org/ref/epsg/25830/proj4/
        {
          resolutions: [2048, 1024, 512, 256, 128, 64, 32, 16, 8, 4, 2, 1, 0.5],
          //Origen de servicio teselado
          //origin:[0,0]
        });
    } catch (e) {
      console.log(e);
    }

    var map = L.map('map', {
      crs: crs25830,
      minZoom: -10,
      maxZoom: 15,
    }).setView( [4616777.07421584, 675829.86195912], 1);

 /*   var torresP1 = L.tileLayer.wms("http://91.250.168.62:8082/geoserver/wms?service=WMS&", {
      crs: crs25830,
      layers: "SmartCampus:TorresP1",//nombre de la capa (ver get capabilities)
      format: 'image/jpeg',
      transparent: true,
      version: '1.1.0',//wms version (ver get capabilities)
      attribution: "UNIZAR"
    }).addTo(map);*/
//console.log(L);
//console.log(proj4L);
    /*var vectorGrid = L.vectorGrid.slicer( this.jsonEx, {
      maxZoom: 20,
      rendererFactory: L.svg.tile,
      vectorTileLayerStyles: {
        sliced: {
          weight: 2,
          color: 'red',
          opacity: 1,
          fillColor: 'yellow',
          fill: true,
          radius: 6,
          fillOpacity: 0.7
        }
      }
    });

    vectorGrid.addTo(map);*/

    var myLayer = L.geoJson().addTo(map);
    myLayer.addData(this.jsonEx);
    //console.log(this.jsonEx);
    //console.log(myLayer);

    //L.geoJson().addTo(map);

    /*var source = L.WMS.source("http://91.250.168.62:8082/geoserver/wms?", {
      opacity: 0.1,
    });
    source.getLayer("SmartCampus:TorresP1").addTo(map);*/

  }



  goReservas() {
    const redirectUrl = '/reserva';
    // Redirect the user
    this.router.navigate([redirectUrl]);
  }

  goBusqueda() {
    this.router.navigate(["/busqueda"]);
  }

  goLoginGerencia() {
      this.matDialog.open(LoginComponent, {
        width: '500px',
        height: '400px'
      });

  }

  // Para cuando se seleccione un espacio en el mapa
  goSeleccionEspacios() {
    const redirectUrl = '/seleccion-espacios';

    // Redirect the user
    this.router.navigate([redirectUrl]);
  }


}
